<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Bayern Tickets">
  <meta name="theme-color" content="#dc2626">
  <title>FC Bayern Tickets 25/26</title>
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">
  
  <!-- Apple Touch Icon -->
  <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='45' fill='%23dc2626'/><text x='50' y='65' font-size='50' text-anchor='middle' fill='white'>‚öΩ</text></svg>">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- React -->
  <script crossorigin src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script crossorigin src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.23.5/babel.min.js"></script>
  
  <style>
    body { 
      margin: 0; 
      padding: 0; 
      overflow-x: hidden;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <!-- Service Worker Registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(reg => console.log('SW registered'))
          .catch(err => console.log('SW registration failed'));
      });
    }
  </script>
  
  <script type="text/babel">
    const { useState, useEffect } = React;
    
    // Icon components
    const Edit2 = ({ className = "" }) => <span className={className} style={{fontSize: '16px'}}>‚úèÔ∏è</span>;
    const Check = ({ className = "" }) => <span className={className} style={{fontSize: '14px'}}>‚úì</span>;
    const X = ({ className = "" }) => <span className={className} style={{fontSize: '14px'}}>‚úó</span>;
    const Save = ({ className = "" }) => <span className={className} style={{fontSize: '16px'}}>üíæ</span>;
    const Users = ({ className = "" }) => <span className={className} style={{fontSize: '16px'}}>üë•</span>;
    const ChevronDown = ({ className = "" }) => <span className={className} style={{fontSize: '12px'}}>‚ñº</span>;
    const ChevronUp = ({ className = "" }) => <span className={className} style={{fontSize: '12px'}}>‚ñ≤</span>;

const BayernTicketDashboard = () => {
  const initialData = {
    "bundesliga": [
      { "spieltag": "1", "datum": "Fr., 22.08.2025 (20:30)", "gegner": "RB Leipzig", "nutzer": "Mama, Papa", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "3", "datum": "Sa., 13.09.2025", "gegner": "Hamburger SV", "nutzer": "Dominik", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "5", "datum": "Fr., 26.09.2025", "gegner": "Werder Bremen", "nutzer": "Christoph, Papa", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "7", "datum": "17.‚Äì19.10.2025", "gegner": "Borussia Dortmund", "nutzer": "Sebastian, Claves", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "9", "datum": "31.10.‚Äì02.11.2025", "gegner": "Bayer Leverkusen", "nutzer": "Sophia", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "11", "datum": "21.‚Äì23.11.2025", "gegner": "SC Freiburg", "nutzer": "Danny", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "12", "datum": "28.‚Äì30.11.2025", "gegner": "FC St. Pauli", "nutzer": "Ralf Erhart", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "14", "datum": "12.‚Äì14.12.2025", "gegner": "FSV Mainz 05", "nutzer": "Max Kalkusch", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "16", "datum": "09.‚Äì11.01.2026", "gegner": "VfL Wolfsburg", "nutzer": "Lederer Michael", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "19", "datum": "23.‚Äì25.01.2026", "gegner": "FC Augsburg", "nutzer": "Dora Skrybus-Loy", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "21", "datum": "06.‚Äì08.02.2026", "gegner": "TSG Hoffenheim", "nutzer": "Tom Petri", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "23", "datum": "20.‚Äì22.02.2026", "gegner": "Eintracht Frankfurt", "nutzer": "Danny", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "25", "datum": "06.‚Äì08.03.2026", "gegner": "Borussia M'gladbach", "nutzer": "Ruben", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "27", "datum": "20.‚Äì22.03.2026", "gegner": "Union Berlin", "nutzer": "Majewski", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "30", "datum": "17.‚Äì19.04.2026", "gegner": "VfB Stuttgart", "nutzer": "Sophia", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "32", "datum": "02.‚Äì03.05.2026", "gegner": "1. FC Heidenheim", "nutzer": "Tim", "versendet": "Ja", "bezahlt": "Nein", "papa_weitergeleitet": "Nein", "notizen": "" },
      { "spieltag": "34", "datum": "Sa., 16.05.2026 (15:30)", "gegner": "1. FC K√∂ln", "nutzer": "Mama, Papa", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" }
    ],
    "champions_league": [
      { "spieltag": "MD 1", "datum": "Mi., 17.09.2025 (21:00)", "gegner": "Chelsea", "nutzer": "Ruben", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "MD 2", "datum": "Di., 30.09.2025 (21:00)", "gegner": "Pafos (A)", "nutzer": "", "versendet": "Nein", "bezahlt": "Nein", "papa_weitergeleitet": "Nein", "notizen": "Ausw√§rtsspiel" },
      { "spieltag": "MD 3", "datum": "Mi., 22.10.2025 (21:00)", "gegner": "Club Br√ºgge", "nutzer": "Stefan Wintershoff", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "MD 4", "datum": "Di., 04.11.2025 (21:00)", "gegner": "Paris SG (A)", "nutzer": "", "versendet": "Nein", "bezahlt": "Nein", "papa_weitergeleitet": "Nein", "notizen": "Ausw√§rtsspiel" },
      { "spieltag": "MD 5", "datum": "Mi., 26.11.2025 (21:00)", "gegner": "Arsenal (A)", "nutzer": "", "versendet": "Nein", "bezahlt": "Nein", "papa_weitergeleitet": "Nein", "notizen": "Ausw√§rtsspiel" },
      { "spieltag": "MD 6", "datum": "Di., 09.12.2025 (18:45)", "gegner": "Sporting Lissabon", "nutzer": "Annika schnell", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "MD 7", "datum": "Mi., 21.01.2026 (21:00)", "gegner": "Union Saint-Gilloise", "nutzer": "Annika schnell", "versendet": "Ja", "bezahlt": "Ja", "papa_weitergeleitet": "Ja", "notizen": "" },
      { "spieltag": "MD 8", "datum": "Mi., 28.01.2026 (21:00)", "gegner": "PSV Eindhoven (A)", "nutzer": "", "versendet": "Nein", "bezahlt": "Nein", "papa_weitergeleitet": "Nein", "notizen": "Ausw√§rtsspiel" }
    ]
  };

  const [data, setData] = useState(initialData);
  const [activeTab, setActiveTab] = useState('bundesliga');
  const [editingIndex, setEditingIndex] = useState(null);
  const [editForm, setEditForm] = useState({});
  const [showSaved, setShowSaved] = useState(false);
  const [filter, setFilter] = useState('all');
  const [waitlist, setWaitlist] = useState([
    { name: 'Ann-Marie G√∂tz+Flo', notizen: '', priority: 'normal' },
    { name: 'Stefan Wintershoff', notizen: '', priority: 'normal' },
    { name: 'Annika schnell', notizen: '', priority: 'normal' },
    { name: 'Dominik Lutz', notizen: '', priority: 'normal' }
  ]);
  const [showWaitlist, setShowWaitlist] = useState(false);
  const [editingWaitlistIndex, setEditingWaitlistIndex] = useState(null);
  const [waitlistForm, setWaitlistForm] = useState({});
  const [showKOModal, setShowKOModal] = useState(false);
  const [koRound, setKoRound] = useState('');
  const [koGegner, setKoGegner] = useState('');
  const [koDatum, setKoDatum] = useState('');
  const [isSearching, setIsSearching] = useState(false);
  const [searchError, setSearchError] = useState('');

  // Load data from localStorage on mount
  React.useEffect(() => {
    const savedData = localStorage.getItem('bayern_tickets_data');
    const savedWaitlist = localStorage.getItem('bayern_tickets_waitlist');
    
    if (savedData) {
      try {
        setData(JSON.parse(savedData));
      } catch (e) {
        console.error('Error loading data:', e);
      }
    }
    
    if (savedWaitlist) {
      try {
        setWaitlist(JSON.parse(savedWaitlist));
      } catch (e) {
        console.error('Error loading waitlist:', e);
      }
    }
  }, []);

  // Save data to localStorage whenever it changes
  React.useEffect(() => {
    localStorage.setItem('bayern_tickets_data', JSON.stringify(data));
  }, [data]);

  // Save waitlist to localStorage whenever it changes
  React.useEffect(() => {
    localStorage.setItem('bayern_tickets_waitlist', JSON.stringify(waitlist));
  }, [waitlist]);

  const stats = {
    bundesliga: {
      total: data.bundesliga.length,
      versendet: data.bundesliga.filter(g => g.versendet === 'Ja').length,
      bezahlt: data.bundesliga.filter(g => g.bezahlt === 'Ja').length,
      offen: data.bundesliga.filter(g => g.bezahlt === 'Nein' || g.versendet === 'Nein').length
    },
    cl: {
      // Only count home games (not Ausw√§rtsspiele)
      total: data.champions_league.filter(g => g.gegner && !g.gegner.includes('(A)')).length,
      versendet: data.champions_league.filter(g => g.versendet === 'Ja' && !g.gegner.includes('(A)')).length,
      bezahlt: data.champions_league.filter(g => g.bezahlt === 'Ja' && !g.gegner.includes('(A)')).length,
      offen: data.champions_league.filter(g => (g.bezahlt === 'Nein' || g.versendet === 'Nein') && g.gegner && !g.gegner.includes('(A)')).length
    }
  };

  const startEdit = (index, game) => {
    setEditingIndex(index);
    setEditForm({...game});
  };

  const cancelEdit = () => {
    setEditingIndex(null);
    setEditForm({});
  };

  const saveEdit = (index) => {
    const newData = {...data};
    newData[activeTab][index] = editForm;
    setData(newData);
    setEditingIndex(null);
    setEditForm({});
    setShowSaved(true);
    setTimeout(() => setShowSaved(false), 2000);
  };

  const toggleStatus = (field, index) => {
    const newData = {...data};
    newData[activeTab][index][field] = newData[activeTab][index][field] === 'Ja' ? 'Nein' : 'Ja';
    setData(newData);
    setShowSaved(true);
    setTimeout(() => setShowSaved(false), 2000);
  };

  const handleFilterClick = (newFilter) => {
    setFilter(filter === newFilter ? 'all' : newFilter);
  };

  const addToWaitlist = () => {
    setWaitlist([...waitlist, { name: '', notizen: '', priority: 'normal' }]);
    setEditingWaitlistIndex(waitlist.length);
    setWaitlistForm({ name: '', notizen: '', priority: 'normal' });
  };

  const saveWaitlistEntry = (index) => {
    const newWaitlist = [...waitlist];
    newWaitlist[index] = waitlistForm;
    setWaitlist(newWaitlist);
    setEditingWaitlistIndex(null);
    setWaitlistForm({});
    setShowSaved(true);
    setTimeout(() => setShowSaved(false), 2000);
  };

  const deleteWaitlistEntry = (index) => {
    setWaitlist(waitlist.filter((_, i) => i !== index));
    setShowSaved(true);
    setTimeout(() => setShowSaved(false), 2000);
  };

  const startEditWaitlist = (index, entry) => {
    setEditingWaitlistIndex(index);
    setWaitlistForm({...entry});
  };

  const cancelEditWaitlist = () => {
    setEditingWaitlistIndex(null);
    setWaitlistForm({});
  };

  const searchNextCLGame = () => {
    setShowKOModal(true);
    setKoRound('');
    setKoGegner('');
    setKoDatum('');
    setSearchError('Die n√§chste K.O.-Runde steht noch nicht fest.\n\nüìÖ Auslosung Achtelfinale: 27. Februar 2026\n\n‚öΩ M√∂gliche Gegner (Playoff-Sieger):\n‚Ä¢ Atalanta Bergamo oder Borussia Dortmund\n‚Ä¢ Bayer Leverkusen oder Olympiakos Pir√§us\n\nBitte trage die Daten nach der Auslosung manuell ein.');
  };

  const addKOGame = () => {
    if (!koGegner || !koDatum || !koRound) return;
    
    const newData = {...data};
    newData.champions_league.push({
      spieltag: koRound,
      datum: koDatum,
      gegner: koGegner,
      nutzer: '',
      versendet: 'Nein',
      bezahlt: 'Nein',
      papa_weitergeleitet: 'Nein',
      notizen: ''
    });
    setData(newData);
    setShowKOModal(false);
    setKoRound('');
    setKoGegner('');
    setKoDatum('');
    setSearchError('');
    setShowSaved(true);
    setTimeout(() => setShowSaved(false), 2000);
  };

  const games = activeTab === 'bundesliga' ? data.bundesliga : data.champions_league;
  const currentStats = activeTab === 'bundesliga' ? stats.bundesliga : stats.cl;

  // Filter CL games to show only home games
  const displayGames = activeTab === 'champions_league' 
    ? games.filter(game => !game.gegner.includes('(A)'))
    : games;

  const filteredGames = displayGames.filter(game => {
    if (filter === 'all') return true;
    if (filter === 'versendet') return game.versendet === 'Ja';
    if (filter === 'bezahlt') return game.bezahlt === 'Ja';
    if (filter === 'offen') return game.versendet === 'Nein' || game.bezahlt === 'Nein';
    return true;
  });

  const StatusBadge = ({ status, onClick }) => (
    <button
      onClick={onClick}
      className={`w-6 h-6 rounded flex items-center justify-center transition-all ${
        status === 'Ja' 
          ? 'bg-emerald-500 text-white' 
          : 'bg-gray-700 text-gray-500'
      }`}
    >
      {status === 'Ja' ? <Check className="w-4 h-4" /> : <X className="w-3 h-3" />}
    </button>
  );

  return (
    <div className="min-h-screen bg-gray-950 text-white">
      <style>{`
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        * { font-family: 'Inter', sans-serif; }
        
        @keyframes slideDown {
          from { opacity: 0; transform: translateY(-10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-slide { animation: slideDown 0.2s ease-out; }
      `}</style>

      {showSaved && (
        <div className="fixed top-4 right-4 z-50 animate-slide">
          <div className="bg-emerald-500 text-white px-4 py-2 rounded-lg shadow-xl text-sm font-medium">
            ‚úì Gespeichert
          </div>
        </div>
      )}

      {/* Compact Header */}
      <div className="bg-gray-900 border-b border-gray-800 sticky top-0 z-40">
        <div className="px-4 py-3">
          <div className="flex items-center gap-2 mb-3">
            <div className="w-8 h-8 bg-red-600 rounded flex items-center justify-center text-lg">‚öΩ</div>
            <h1 className="text-lg font-bold">FCB Tickets 25/26</h1>
          </div>
          
          {/* Stats */}
          <div className="grid grid-cols-2 gap-2 text-center text-xs">
            <button onClick={() => handleFilterClick('all')} className={`p-2 rounded ${filter === 'all' ? 'bg-gray-800 ring-1 ring-red-500' : 'bg-gray-800/50'}`}>
              <div className="font-bold text-base">{currentStats.total}</div>
              <div className="text-gray-400">Gesamt</div>
            </button>
            <button onClick={() => handleFilterClick('offen')} className={`p-2 rounded ${filter === 'offen' ? 'bg-gray-800 ring-1 ring-amber-500' : 'bg-gray-800/50'}`}>
              <div className="font-bold text-base text-amber-400">{currentStats.offen}</div>
              <div className="text-gray-400">Offen</div>
            </button>
          </div>

          {/* Tabs */}
          <div className="flex gap-2 mt-3">
            <button
              onClick={() => { setActiveTab('bundesliga'); setFilter('all'); }}
              className={`flex-1 py-2 rounded font-semibold text-sm ${
                activeTab === 'bundesliga' ? 'bg-red-600' : 'bg-gray-800'
              }`}
            >
              Bundesliga
            </button>
            <button
              onClick={() => { setActiveTab('champions_league'); setFilter('all'); }}
              className={`flex-1 py-2 rounded font-semibold text-sm ${
                activeTab === 'champions_league' ? 'bg-red-600' : 'bg-gray-800'
              }`}
            >
              CL
            </button>
          </div>
        </div>

        {/* Waitlist */}
        <div className="border-t border-gray-800">
          <button
            onClick={() => setShowWaitlist(!showWaitlist)}
            className="w-full px-4 py-2 flex items-center justify-between text-sm bg-purple-950/20"
          >
            <div className="flex items-center gap-2">
              <Users className="w-4 h-4 text-purple-400" />
              <span className="font-medium">Warteliste 26/27</span>
              <span className="text-gray-500">({waitlist.length})</span>
            </div>
            {showWaitlist ? <ChevronUp className="w-4 h-4" /> : <ChevronDown className="w-4 h-4" />}
          </button>

          {showWaitlist && (
            <div className="px-4 py-2 space-y-2 bg-gray-900/50">
              {waitlist.map((person, index) => {
                const isEditing = editingWaitlistIndex === index;
                return (
                  <div key={index} className="bg-gray-800 rounded p-2 text-sm">
                    {isEditing ? (
                      <div className="space-y-2">
                        <input
                          type="text"
                          value={waitlistForm.name || ''}
                          onChange={(e) => setWaitlistForm({...waitlistForm, name: e.target.value})}
                          className="w-full bg-gray-700 px-2 py-1 rounded text-sm"
                          placeholder="Name"
                        />
                        <textarea
                          value={waitlistForm.notizen || ''}
                          onChange={(e) => setWaitlistForm({...waitlistForm, notizen: e.target.value})}
                          className="w-full bg-gray-700 px-2 py-1 rounded text-sm h-16"
                          placeholder="Notizen"
                        />
                        <select
                          value={waitlistForm.priority || 'normal'}
                          onChange={(e) => setWaitlistForm({...waitlistForm, priority: e.target.value})}
                          className="w-full bg-gray-700 px-2 py-1 rounded text-sm"
                        >
                          <option value="high">Hoch</option>
                          <option value="normal">Normal</option>
                          <option value="low">Niedrig</option>
                        </select>
                        <div className="flex gap-2">
                          <button onClick={() => saveWaitlistEntry(index)} className="flex-1 bg-emerald-600 py-1 rounded text-xs font-medium">Speichern</button>
                          <button onClick={cancelEditWaitlist} className="flex-1 bg-gray-700 py-1 rounded text-xs font-medium">Abbrechen</button>
                        </div>
                      </div>
                    ) : (
                      <div className="flex items-center justify-between">
                        <div className="flex items-center gap-2 flex-1">
                          <div className={`w-2 h-2 rounded-full ${person.priority === 'high' ? 'bg-red-400' : person.priority === 'low' ? 'bg-gray-400' : 'bg-yellow-400'}`} />
                          <div className="flex-1">
                            <div className="font-medium">{person.name || 'Unbenannt'}</div>
                            {person.notizen && <div className="text-xs text-gray-400 truncate">{person.notizen}</div>}
                          </div>
                        </div>
                        <div className="flex gap-1">
                          <button onClick={() => startEditWaitlist(index, person)} className="p-1 bg-gray-700 rounded">
                            <Edit2 className="w-3 h-3" />
                          </button>
                          <button onClick={() => deleteWaitlistEntry(index)} className="p-1 bg-red-900/30 rounded text-red-400">
                            <X className="w-3 h-3" />
                          </button>
                        </div>
                      </div>
                    )}
                  </div>
                );
              })}
              <button onClick={addToWaitlist} className="w-full py-2 border border-dashed border-gray-700 rounded text-purple-400 text-sm">
                + Person hinzuf√ºgen
              </button>
            </div>
          )}
        </div>
      </div>

      {/* Games List */}
      <div className="p-3 space-y-2">
        {/* CL K.O. Button */}
        {activeTab === 'champions_league' && (
          <button
            onClick={searchNextCLGame}
            className="w-full bg-gradient-to-r from-blue-600 to-blue-700 py-3 rounded-lg font-semibold text-sm flex items-center justify-center gap-2"
          >
            <span className="text-lg">+</span>
            K.O.-Runde hinzuf√ºgen
          </button>
        )}

        {filter !== 'all' && (
          <div className="bg-gray-900 rounded p-2 text-xs flex items-center justify-between">
            <span className="text-gray-400">{filteredGames.length} von {displayGames.length} Spielen</span>
            <button onClick={() => setFilter('all')} className="text-red-400 font-medium">Zur√ºcksetzen</button>
          </div>
        )}

        {filteredGames.length === 0 ? (
          <div className="text-center py-12 text-gray-500">
            <div className="text-4xl mb-2">üîç</div>
            <div className="text-sm">Keine Spiele gefunden</div>
            <button onClick={() => setFilter('all')} className="mt-3 bg-red-600 px-4 py-2 rounded text-sm font-medium">
              Alle anzeigen
            </button>
          </div>
        ) : (
          filteredGames.map((game, index) => {
            const originalIndex = games.findIndex(g => g === game);
            const isEditing = editingIndex === originalIndex;

            return (
              <div key={originalIndex} className="bg-gray-900 rounded-lg overflow-hidden">
                {isEditing ? (
                  <div className="p-3 space-y-2">
                    <input type="text" value={editForm.spieltag || ''} onChange={(e) => setEditForm({...editForm, spieltag: e.target.value})} className="w-full bg-gray-800 px-2 py-1 rounded text-sm" placeholder="Spieltag" />
                    <input type="text" value={editForm.datum || ''} onChange={(e) => setEditForm({...editForm, datum: e.target.value})} className="w-full bg-gray-800 px-2 py-1 rounded text-sm" placeholder="Datum" />
                    <input type="text" value={editForm.gegner || ''} onChange={(e) => setEditForm({...editForm, gegner: e.target.value})} className="w-full bg-gray-800 px-2 py-1 rounded text-sm" placeholder="Gegner" />
                    <input type="text" value={editForm.nutzer || ''} onChange={(e) => setEditForm({...editForm, nutzer: e.target.value})} className="w-full bg-gray-800 px-2 py-1 rounded text-sm" placeholder="Nutzer" />
                    <textarea value={editForm.notizen || ''} onChange={(e) => setEditForm({...editForm, notizen: e.target.value})} className="w-full bg-gray-800 px-2 py-1 rounded text-sm h-16" placeholder="Notizen" />
                    <div className="flex gap-2">
                      <button onClick={() => saveEdit(originalIndex)} className="flex-1 bg-emerald-600 py-2 rounded text-sm font-medium flex items-center justify-center gap-1">
                        <Save className="w-4 h-4" /> Speichern
                      </button>
                      <button onClick={cancelEdit} className="flex-1 bg-gray-700 py-2 rounded text-sm font-medium">Abbrechen</button>
                    </div>
                  </div>
                ) : (
                  <div className="p-3">
                    <div className="flex items-start justify-between mb-2">
                      <div className="flex-1">
                        <div className="flex items-center gap-2 mb-1">
                          <span className="text-xs font-medium text-red-400 bg-red-950/50 px-2 py-0.5 rounded">{game.spieltag}</span>
                          <h3 className="font-bold text-sm">vs {game.gegner}</h3>
                        </div>
                        <div className="text-xs text-gray-400">{game.datum}</div>
                      </div>
                      <button onClick={() => startEdit(originalIndex, game)} className="p-1.5 bg-gray-800 rounded">
                        <Edit2 className="w-4 h-4" />
                      </button>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                      <div className="bg-gray-800/50 rounded p-2 mb-2">
                        <div className="text-xs text-gray-400 mb-1">Nutzer</div>
                        <div className="font-medium text-sm">{game.nutzer || '-'}</div>
                      </div>

                      <div className="grid grid-cols-3 gap-2 text-xs">
                        <div>
                          <div className="text-gray-500 mb-1">Karten verschickt</div>
                          <StatusBadge status={game.versendet} onClick={() => toggleStatus('versendet', originalIndex)} />
                        </div>
                        <div>
                          <div className="text-gray-500 mb-1">Geld erhalten</div>
                          <StatusBadge status={game.bezahlt} onClick={() => toggleStatus('bezahlt', originalIndex)} />
                        </div>
                        <div>
                          <div className="text-gray-500 mb-1">An Papa geschickt</div>
                          <StatusBadge status={game.papa_weitergeleitet} onClick={() => toggleStatus('papa_weitergeleitet', originalIndex)} />
                        </div>
                      </div>
                    </div>

                    {game.notizen && (
                      <div className="mt-2 bg-blue-950/30 rounded p-2 text-xs text-blue-200">
                        {game.notizen}
                      </div>
                    )}
                  </div>
                )}
              </div>
            );
          })
        )}
      </div>

      {/* K.O. Round Modal */}
      {showKOModal && (
        <div className="fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4">
          <div className="bg-gray-900 rounded-xl w-full max-w-md p-4 animate-slide">
            <h3 className="text-lg font-bold mb-4">K.O.-Runde hinzuf√ºgen</h3>
            
            {searchError && (
              <div className="mb-4 bg-amber-900/30 border border-amber-700 rounded-lg p-3 text-sm text-amber-200">
                <div className="font-semibold mb-1">‚ÑπÔ∏è Information</div>
                <div className="whitespace-pre-wrap">{searchError}</div>
              </div>
            )}
            
            <div className="space-y-3">
              <div>
                <label className="block text-sm font-medium text-gray-400 mb-1">Runde</label>
                <select
                  value={koRound}
                  onChange={(e) => setKoRound(e.target.value)}
                  className="w-full bg-gray-800 px-3 py-2 rounded text-sm"
                >
                  <option value="">Bitte w√§hlen...</option>
                  <option value="Achtelfinale (Hinspiel)">Achtelfinale (Hinspiel)</option>
                  <option value="Achtelfinale (R√ºckspiel)">Achtelfinale (R√ºckspiel)</option>
                  <option value="Viertelfinale (Hinspiel)">Viertelfinale (Hinspiel)</option>
                  <option value="Viertelfinale (R√ºckspiel)">Viertelfinale (R√ºckspiel)</option>
                  <option value="Halbfinale (Hinspiel)">Halbfinale (Hinspiel)</option>
                  <option value="Halbfinale (R√ºckspiel)">Halbfinale (R√ºckspiel)</option>
                  <option value="Finale">Finale</option>
                </select>
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-400 mb-1">Gegner</label>
                <input
                  type="text"
                  value={koGegner}
                  onChange={(e) => setKoGegner(e.target.value)}
                  placeholder="z.B. Real Madrid"
                  className="w-full bg-gray-800 px-3 py-2 rounded text-sm"
                />
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-400 mb-1">Datum</label>
                <input
                  type="text"
                  value={koDatum}
                  onChange={(e) => setKoDatum(e.target.value)}
                  placeholder="z.B. Di., 11.02.2026 (21:00)"
                  className="w-full bg-gray-800 px-3 py-2 rounded text-sm"
                />
              </div>

              <div className="flex gap-2 pt-2">
                <button
                  onClick={addKOGame}
                  className="flex-1 bg-emerald-600 hover:bg-emerald-700 py-2 rounded font-semibold text-sm"
                >
                  Hinzuf√ºgen
                </button>
                <button
                  onClick={() => {
                    setShowKOModal(false);
                    setKoRound('');
                    setKoGegner('');
                    setKoDatum('');
                    setSearchError('');
                  }}
                  className="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded font-semibold text-sm"
                >
                  Abbrechen
                </button>
              </div>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};



    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<BayernTicketDashboard />);
  </script>
</body>
</html>
